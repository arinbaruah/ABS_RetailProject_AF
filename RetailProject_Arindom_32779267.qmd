---
title: "Retail forecasting project"
author: "Arindom Baruah"
format: html
execute: 
  echo: false
  message: false
  warning: false
number-sections: true
---

```{r}
library(fpp3)
library(tidyverse)
library(kableExtra)
library(latex2exp)
library(plotly)
```
```{r}
library(fpp3)
get_my_data <- function(student_id) {
  set.seed(student_id)
  all_data <- readr::read_rds("https://bit.ly/monashretaildata")
  while(TRUE) {
    retail <- filter(all_data, `Series ID` == sample(`Series ID`, 1))
    if(!any(is.na(fill_gaps(retail)$Turnover))) return(retail)
  }
}
# Replace the argument with your student ID
retail <- get_my_data(32779267)
```


```{r}
get_my_data <- function(student_id) {
  set.seed(student_id)
  all_data <- fill_gaps(readr::read_rds("https://bit.ly/monashretaildata"))
  while(TRUE) {
    retail <- filter(all_data, `Series ID` == sample(`Series ID`, 1)) 
    if(!any(is.na(retail$Turnover))) return(retail)
  }
}
# Replace the argument with your student ID
retail <- get_my_data(32779267)

```


# Statistical features of the data


## Complete timeseries data

Let us observe the time series data for the turnover generated.

```{r}
#| label: fig-turnover
#| fig-cap: "Footwear and personal accessory retailing turnover \n in Western Australia over time"
retail %>% autoplot(Turnover) + labs(x = "Timeline (in Months)",y = "Turnover (mil $)",title="Footwear and personal accessory retailing turnover \n in Western Australia over time",caption = "Source: Australian Bureau of Statistics") + geom_point(data = NULL, aes(x = "2020-02-15", y = 50), color = "red", shape = 1, size = 7) + theme_minimal()


```
:::{.callout-note}
# Key takeaway

Based on @fig-turnover we can observe the following details in the timeseries plot:

1. There appears to be a seasonality in the plot with a spike being observed on every December of a year. __The seasonality additionally appears to be consistent throughout the plot.__

2. The amplitude of the spikes observed in the data appear to be increasing with time. __This indicates that the variation in seasonality of the data is multiplicative in nature.__

3. The plot also indicates the presence of an __additive trend__ in the data with overall turnover increasing every year except for the year of 2020 in an __approximate linear fashion.__ 

4. There appears to be an __outlier in the data during the year of 2020__ as indicated by the <span style=color:red>red cricle</span>. While we expect a drop in retailing turnover in the early months of a year due to a strong retailing period in the previous December, however, __in the year of 2020, the drop in turnover was considerably lower than all the other years.__ This is expected to be caused due to __shutting down of businesses and their activities in the initial part of the COVID-19 pandemic.__
:::

## Variations of trade within a year {#sec-season}



```{r}
#| label: fig-seasonplot
#| fig-cap: "Variation of footwear and personal accessory retailing turnover \n within a year in Western Australia"


ggplotly(retail %>% gg_season(Turnover) + labs(x = "Month",y = "Turnover (mil $)",title="Variation of footwear and personal accessory retailing turnover \n within a year in Western Australia",caption = "Source: Australian Bureau of Statistics")  + theme_minimal(),tooltip = c("Turnover","Month"))

```
:::{.callout-note} 
# Key takeaway
@fig-seasonplot illustrates the variation of turnover within each year generated by the retailers in Western Australia each year. Some key observations are as follows:

1. The turnover generated in Western Australia has been on a rise each year. This suggests that the expenditure of people on footwear and personal accessory retailing services in WA have been increasing each year and could be attributed to the growing population in the state. 

2. We observe that the retailing turnovers in each year are __generally higher in the months of November and December__. This could be a result of the festive period when there are many customers purchasing gifts for families and friends or due to the __special sales promotions such as Boxing Day sales.__

3. Additionally, the month of November also includes the __Black Friday sale__ which attracts multiple customers to purchase items __due to specialised and limited time promotions.__ This may explain the slight rise in turnover during the month of November each year.

4. The __rise in the retail turnovers for the month of December is especially higher during the more recent years (2011-2021)__. This could again be an indicator for the growing population in the country during this period, which has gone on to to create a bigger market and drive sales, hence, contributing to the higher turnover.

5. There appears to be __one single year when the retail turnover dropped steeply in the month of April but eventually picked up for the rest of the year.__ This could be an indicator of the effects of the COVID-19 lockdown when the business activities were very limited and prevented multiple retailers in various regions of Australia, including the state of Western Australia to be able to generate revenue.

:::

## Comparison of turnovers in each month of retail trade

```{r}
#| label: fig-subseries
#| fig-cap: "Variation of footwear and personal accessory retailing turnover in each month of a year in Australia"

retail %>% gg_subseries(Turnover) + labs(x = "Year",y = "Turnover (mil $)",title="Variation of footwear and personal accessory retailing turnover \n in each month of a year in Western Australia",caption = "Source: Australian Bureau of Statistics")  
```

:::{.callout-note}
# Key takeaway

@fig-subseries illustrates the variation of retailing turnover faceted by each month and plotted against years. Key observations are as follows:

1. As already observed in @sec-season, the plot suggests that the __retailing turnover has increased each year from 1990 to 2022.__

2. The average __retail turnover is observed to be higher for the month of December when compared to the rest of the year.__ As explained previously, the main driver for the boost of retailing turnover in this period is attributed to the festive season which includes __Christmas, Boxing Day and the run up to the New Year Eve.__

3. A __drop in retail turnover for the months of March, April and May was observed in 2020.__ This can be attributed to the lockdowns set in place when the pandemic outbreak was first experienced.
:::




